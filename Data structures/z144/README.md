#  Задача 144. Кодирование Танстелла

*Имя входного файла: Tunstall.in*

*ИИмя выходного файла: Tunstall.out*

*Ограничение по времени: 1 с*

*Ограничение по памяти: нет*

Кодирование Танстелла, в отличие от кодирования Хаффмана, является равномерным, т. е. все кодовые слова имеют одинаковую длину. Соответственно, переменную длину, равную в среднем l, имеют кодируемые сообщения. сообщение, необходимо, по аналогии с неравномерным префиксным кодированием, чтобы ни одно сообщение не было префиксом другого сообщения.

Рассмотрим k-ичный источник без памяти с алфавитом A = { a1, a2, …, ak } и вероятностями f(ai) отдельных букв. Назовём комплектным деревом k-ичное направленное дерево, в котором из каждой вершины выходят либо k, либо 0 дуг, а множество сообщений, соответствующее вершинам этого дерева,— комплектным множеством сообщений. В алгоритме Танстелла каждое ребро комплектного дерева помечено символом ai входного алфавита. Таким образом, каждой вершине этого дерева можно поставить в соответствие некоторую цепочку из последовательности символов входного алфавита на пути из корня до этой вершины. Каждую вершину комплектного дерева можно пометить некоторым действительным числом p, равным вероятности появления соответствующей этой вершине цепочки. Процесс расщепления некоторой вершины комплектного дерева заключается в следующем: создаётся k новых вершин, которые становятся сыновьями данной вершины. Дуги к ним помечаются символами ai, а сами вершины — числами p ⋅ f(ai) соответственно.

Процесс построения кода заключается в следующем: вначале комплектное дерево пустое и состоит из одного лишь корня, которому соответствует метка 1. Множество активных вершин состоит из одного лишь корня. На каждом шаге алгоритма из множества активных вершин выбирается вершина с наибольшей меткой и расщепляется. Далее сама она из множества активных вершин исключается, а его сыновья в это множество включаются.

Пусть нам требуется получить d-ичный код с длиной кодового слова равной n. Тогда процесс расщепления продолжается до тех пор, пока число листьев в комплектном дереве не станет максимальным, не превосходящим dn. После этого каждому листу ставится в соответствие произвольное уникальное d-ичное кодовое слово длины n.

Листья дерева представляют сообщения источника, которые необходимо закодировать. Средней длиной сообщения назовём сумму произведений длин всех сообщений на их вероятности. Задача состоит в том, чтобы по данным d, k, n и f(ai) определить среднюю длину сообщения в коде Танстелла.

**Формат входных данных**

Первая строка содержит три целых числа d, k и n (2 ≤ d, k, n ≤ 10, dn ≤ 5 000 000). Вторая строка содержит k чисел f(ai) — вероятности появления символов алфавита в источнике (0 ≤ f(ai) ≤ 1, сумма всех f(ai) равна 1). Вероятности заданы не более чем с пятью знаками после запятой.

**Формат выходных данных**

Выведите среднюю длину сообщения в коде Танстелла, вычисленную с точностью до трёх знаков после запятой.
